Vue.prototype.$http=axios,Vue.prototype.$https=axios,Vue.prototype.$b2JsonData=[];var b2_rest_url=b2_global.rest_url+"b2/v1/",b2zoom=new Zooming({enableGrab:!0,scrollThreshold:0,transitionDuration:.2,scaleBase:.96,scaleExtra:1,customSize:"100%"}),B2ClientWidth=document.body.clientWidth,lazyLoadInstance=new LazyLoad({elements_selector:".lazy"});const b2token=b2getCookie("b2_token");function b2WidgetImageLoaded(){imagesLoaded(document.querySelectorAll(".widget-area"),(function(t){b2SidebarSticky()}))}function b2isWeixin(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}b2token&&(Vue.prototype.$http.defaults.headers.common.Authorization="Bearer "+b2token),Vue.prototype.$store=new Vuex.Store({state:{userData:"",announcement:"",oauthLink:"",openOauth:!1,authorData:"",carts:{},_carts:{},canImg:!1},mutations:{setUserData(t,e){t.userData=e},setAnnouncement(t,e){t.announcement=e},setOauthLink(t,e){t.oauthLink=e},setOpenOauth(t,e){t.openOauth=e},setauthorData(t,e){t.authorData=e},setcartsData(t,e){t.carts=e},set_cartsData(t,e){t._carts=e},setcanImage(t,e){t.canImg=e}}}),b2WidgetImageLoaded(),document.ready=function(t){document.addEventListener?document.addEventListener("DOMContentLoaded",(function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),t()}),!1):document.attachEvent?document.attachEvent("onreadystatechange",(function(){"complete"==document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),t())})):document.lastChild==document.body&&t()};var topsearch=new Vue({el:".top-search",data:{type:"post",data:"",show:!1,b2token:!1},mounted(){this.$refs.topsearch&&(this.b2token=b2token,b2GetQueryVariable("type")&&b2GetQueryVariable("s")&&(this.type=b2GetQueryVariable("type")),this.data=b2_global.search_type)}}),mobileMenu=new Vue({el:"#mobile-menu-button",data:{show:!1,b2token:!1},mounted(){B2ClientWidth>=768||(this.b2token=b2token,this.dorpMenu())},methods:{dorpMenu(){let t=document.querySelectorAll(".has_children .b2-arrow-down-s-line");if(t.length>0)for(let e=0;e<t.length;e++)t[e].onclick=t=>{t.stopPropagation(),t.preventDefault(),-1==t.target.parentNode.parentNode.className.indexOf(" show")?(this.hideAll(),t.target.parentNode.parentNode.className+=" show"):this.hideAll()}},hideAll(){let t=document.querySelectorAll(".has_children .sub-menu");for(let e=0;e<t.length;e++)t[e].parentNode.className=t[e].parentNode.className.replace(" show","")},showMenu(t){const e=document.querySelector("#mobile-menu");body=document.querySelector("html"),t?(e.className+=" show-menu-box",body.className+=" m-open",this.show=!0):(e.className=e.className.replace(" show-menu-box",""),setTimeout((()=>{body.className=body.className.replace(" m-open","")}),300),this.show=!1)},showAc(){this.show=!this.show,this.showMenu(this.show)}}});Vue.component("search-box",{props:["show","searchType"],template:b2_global.search_box,data:()=>({showSearch:!1,type:"post"}),methods:{close(){this.$emit("close")}},watch:{searchType(t){this.type=t}}});var b2SearchBox=new Vue({el:"#search-box",data:{searchType:"all",show:!1},methods:{close(){this.show=!this.show}}}),userTools=new Vue({el:".top-user-info",data:{showDrop:!1,role:{write:!0,newsflashes:!1,binding_login:!1,create_circle:!1,create_topic:!1,distribution:!1,user_data:""},b2token:!1},computed:{userData(){return this.$store.state.userData}},mounted(){this.b2token=b2token,document.onclick=()=>{if(this.showDrop=!1,"undefined"!=typeof b2Comment&&(b2Comment.show.smile=!1,b2Comment.show.image=!1),void 0!==b2TaxTop&&(b2TaxTop.showFliter.hot=!1,b2TaxTop.showFliter.cat=!1),void 0!==topsearch&&(topsearch.show=!1),"undefined"!=typeof writeHead&&Qmsg.closeAll(),"undefined"!=typeof b2CirclePostBox&&(b2CirclePostBox.ask.focus=!1,b2CirclePostBox.ask.userInput&&(b2CirclePostBox.ask.picked=!0),b2CirclePostBox.role.show=!1,b2CirclePostBox.smileShow=!1),"undefined"!=typeof b2CircleList){if(!b2CircleList.$refs.topicForm)return;b2CircleList.commentBox.content||(""==b2CircleList.$refs.topicForm.value&&(b2CircleList.commentBox.focus=!1),b2CircleList.smileShow=!1),b2CircleList.circle.showBox="",b2CircleList.topicFliter.show=!1,b2CircleList.answer.showSmile=!1}b2AsideBar.close()};let t=b2GetQueryVariable("ref");if(t||(t=b2getCookie("ref")),b2token){let e=document.querySelector("#footer-menu-user");e&&(e.innerText=b2_global.js_text.global.my),this.$http.post(b2_rest_url+"getUserInfo","ref="+t).then((t=>{this.role=t.data,this.$store.commit("setUserData",t.data.user_data),this.$store.commit("setcanImage",t.data.can_img),b2AsideBar.count=t.data.carts,b2bindLogin.type=t.data.binding_login,payCredit.user.credit=t.data.user_data.credit,this.$nextTick((()=>{b2tooltip(".user-tips")})),t.data.distribution&&b2delCookie("ref")})).catch((t=>{this.loginOut()}))}else this.$https.get(b2_rest_url+"getOauthLink").then((t=>{this.$store.commit("setOauthLink",t.data)})),t&&b2setCookie("ref",t)},methods:{login(t){login.show=!0,login.loginType=t},showDropMenu(){this.showDrop=!this.showDrop},loginOut(){axios.get(b2_rest_url+"loginOut").then((t=>{b2delCookie("b2_token"),location.reload()})).catch((t=>{b2delCookie("b2_token"),location.reload()}))},out(){this.loginOut()},goUserPage(t){if("back"===t)window.location=b2getCookie("b2_back_url");else if(t){if(!b2token)return void this.login(1);window.location=this.$store.state.userData.link+"/"+t}else{if(!b2token)return void this.login(1);window.location=this.$store.state.userData.link}}}}),topMenuLeft=new Vue({el:".change-theme",data:{theme:"light",count:0,login:!1},mounted(){b2token&&(this.login=!0)},methods:{changeTheme(t){this.theme=t},showBox(){postPoBox.show=!0},go(t){"orders"===t&&(b2token?window.location.href=this.$store.state.userData.link+"/orders":(login.show=!0,login.loginType=1)),"requests"===t&&(b2token?window.location.href=b2_global.home_url+"/requests":(login.show=!0,login.loginType=1))}}}),headerTools=new Vue({el:".header-tools",computed:{userData(){return this.$store.state.userData}},methods:{showSearch(){b2SearchBox.close()}}});Vue.component("login-box",{props:["show","allowRegister","checkType","loginType","loginText","invitation","invitationLink","invitationText","imgBoxCode"],template:b2_global.login,data:()=>({data:{nickname:"",username:"",password:"",code:"",img_code:"",invitation_code:"",token:"",smsToken:"",luoToken:"",confirmPassword:"",loginType:""},invitationPass:!1,eye:!1,codeImg:"",locked:!1,showLuo:!1,issetLuo:!1,imgLocked:!1,SMSLocked:!1,count:60,repass:!1,type:"",isWeixin:!1}),computed:{oauth(){return this.$store.state.oauthLink},openOauth(){return this.$store.state.openOauth}},created(){window.getResponse=t=>{"edit"==this.type?(b2AuthorEdit.sendCode(t),recaptcha.close()):(this.data.img_code=t,this.$nextTick((()=>{recaptcha.close(),this.sendSMS()})))},this.isWeixin=b2isWeixin()},methods:{close(t){this.$emit("close-form",t)},loginAc(t){this.$emit("login-ac",t)},loginSubmit(t){t.preventDefault(),1!=this.locked&&(this.locked=!0,0==this.invitation||2!=this.loginType||this.invitationPass?1==this.loginType?this.$https.post(b2_global.rest_url+"jwt-auth/v1/token",Qs.stringify(this.data)).then((t=>{200==t.status&&(this.$store.commit("setUserData",t.data),Vue.prototype.$http.defaults.headers.common.Authorization="Bearer "+b2token),location.reload()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0,timeout:1e4}),this.locked=!1})):2==this.loginType?this.$https.post(b2_rest_url+"regeister",Qs.stringify(this.data)).then((t=>{location.reload()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})):3==this.loginType?this.$https.post(b2_rest_url+"forgotPass",Qs.stringify(this.data)).then((t=>{this.loginAc(4),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})):4==this.loginType&&this.$https.post(b2_rest_url+"resetPass",Qs.stringify(this.data)).then((t=>{this.repass=!0,this.data.password="",this.loginAc(1),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})):this.invitationCheck())},b2IsPhoneAvailable:t=>!!b2IsPhoneAvailable(t),invitationCheck(){this.$https.post(b2_rest_url+"invitationCheck","code="+this.data.invitation_code).then((t=>{this.invitationPass=!0,this.locked=!1,this.showLuo=!0})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))},sendCode(){recaptcha.show=!0,this.close(!1)},getCode(){this.imgLocked||(this.codeImg="",this.imgLocked=!0,this.$https.post(b2_rest_url+"getRecaptcha","number=4&width=186&height=50").then((t=>{t.data&&(this.codeImg=t.data.base,this.data.token=t.data.token),this.imgLocked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.imgLocked=!1})))},changeCode(){this.getCode()},isEmail:t=>/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(t),checkTips(){let t="";"tel"==this.checkType&&(t=b2_global.js_text.global.check_type.tel),"email"==this.checkType&&(t=b2_global.js_text.global.check_type.mail),"telandemail"==this.checkType&&(t=this.isEmail(this.data.username)?b2_global.js_text.global.check_type.mail:b2_global.js_text.global.check_type.tel),t&&Qmsg.info(b2_global.js_text.global.check_message.replace("#",t),{showClose:!0,autoClose:!1})},sendSMS(){this.SMSLocked||(this.SMSLocked=!0,this.data.loginType=this.loginType,this.$https.post(b2_rest_url+"sendCode",Qs.stringify(this.data)).then((t=>{t.data.token&&(this.data.smsToken=t.data.token),this.SMSLocked=!1,this.countdown(),this.checkTips()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.SMSLocked=!1})))},markHistory(t){t&&(this.close(),mpCode.show=!0,mpCode.type=this.loginType),b2setCookie("b2_back_url",window.location.href)},countdown(){this.count<=1?this.count=60:(this.count--,setTimeout((()=>{this.countdown()}),1e3))},resetPssNext(){this.loginAc(4)}},watch:{oauth(t){t&&(Object.keys(t).forEach((e=>{t[e].open&&this.$store.commit("setOpenOauth",!0)})),b2isWeixin()&&1==b2_global.wx_mp_in_login&&(b2token||null!==document.querySelector("#open-page")||(b2setCookie("b2_back_url",window.location.href),window.location.href=this.oauth.weixin.url)))},loginType(t){0!=this.invitation&&!this.invitationPass||2!=t?this.showLuo=!1:this.showLuo=!0,this.issetLuo&&LUOCAPTCHA&&LUOCAPTCHA.reset()},invitationPass(t){this.issetLuo&&t&&setTimeout((()=>{LUOCAPTCHA&&LUOCAPTCHA.reset()}),100)},show(t){t&&"text"==this.checkType&&(this.getCode(),this.type="")},imgBoxCode(t){this.data.img_code=t.value,this.data.token=t.token},showLuo(t){if(this.show&&"luo"==this.checkType&&t&&!this.issetLuo){let t=document.createElement("script");t.id="luosimao",t.type="text/javascript",t.src="//captcha.luosimao.com/static/dist/api.js",document.getElementsByTagName("head")[0].appendChild(t),this.issetLuo=!0}}}}),Vue.component("mp-box",{props:["show","invitation","invitationLink","invitationText"],template:b2_global.mp_box,data:()=>({code:"",locked:!1,token:!1,invitationCode:"",locked:!1,qrcode:"",t:!1,count:100}),methods:{close(){this.$emit("close"),this.t=null},submit(){if(1!=this.locked){if(this.locked=!0,this.count<=1||null===this.t)return this.t=null,void(this.count=100);this.$http.post(b2_rest_url+"mpLogin","code="+this.code).then((t=>{if("waiting"===t.data)return this.locked=!1,void(this.t=setTimeout((()=>{this.submit()}),1e3));"invitation"===t.data.type?this.token=t.data.token:(!0===t.data||(this.$store.commit("setUserData",t.data),Vue.prototype.$http.defaults.headers.common.Authorization="Bearer "+b2token),location.reload()),this.t=null,this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}},checkInv(){1!=this.locked&&(this.locked=!0,this.$https.post(b2_rest_url+"mpLoginInv","token="+this.token+"&inv="+this.invitationCode).then((t=>{t.data.token&&location.reload(),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))},getQrcode(){this.$https.post(b2_rest_url+"getLoginQrcode").then((t=>{this.code=t.data.sence_id,this.qrcode=t.data.qrcode,this.submit()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0})}))}},watch:{show(t){t&&(this.$store.state.oauthLink.weixin.pc_open?b2loadScript("https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js","",(()=>{new WxLogin({self_redirect:!1,id:"mp-login-box",appid:b2_global.wx_appid,scope:"snsapi_login",redirect_uri:b2_global.home_url+"/open?type=weixin",state:"",style:"black",href:"data:text/css;base64,LmltcG93ZXJCb3ggLnFyY29kZSB7DQogICAgd2lkdGg6IDEwMCU7DQogICAgbWFyZ2luLXRvcDogMDsNCiAgICBib3JkZXI6IDA7DQp9DQouaW1wb3dlckJveCAuaW5mbyB7DQogICAgZGlzcGxheTogbm9uZTsNCn0NCi5pbXBvd2VyQm94IC50aXRsZXsNCmRpc3BsYXk6bm9uZQ0KfQ=="})})):(this.locked=!1,this.t=!1,this.count=100,this.getQrcode()))}}});var mpCode=new Vue({el:"#mp-box",data:{show:!1,qrcode:"",type:"1"},methods:{close(){this.show=!this.show,b2token||(login.show=!0,login.loginType=this.type)}}}),login=new Vue({el:"#login-box",data:{show:!1,loginType:1,checkCodeSendSuccess:!1,isAdmin:!1,imgCode:""},methods:{close(t){this.show=t},loginAc(t){this.loginType=t},imgCodeAc(t){this.imgCode=t}}});Vue.component("recaptcha-box",{props:["show","type"],template:b2_global.check_code,data:()=>({recaptcha:"",token:"",recaptchaUrl:"",disabled:!0,issetLuo:!1,locked:!1,loginType:2,checkType:b2_global.check_type}),methods:{close(){this.$emit("close-form")},change(){this.locked||(this.recaptchaUrl="",this.locked=!0,this.$https.post(b2_rest_url+"getRecaptcha","number=4&width=186&height=50").then((t=>{t.data&&(this.recaptchaUrl=t.data.base,this.token=t.data.token),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))},checkCode(){this.disabled||(this.disabled=!0,this.$https.post(b2_rest_url+"imgCodeCheck","img_code="+this.recaptcha+"&token="+this.token+"&loginType="+login.loginType).then((t=>{"edit"==this.type?b2AuthorEdit.imgCodeAc({value:this.recaptcha,token:this.token}):"bind"==this.type?b2bindLogin.imgCodeAc({value:this.recaptcha,token:this.token}):(login.imgCodeAc({value:this.recaptcha,token:this.token}),setTimeout((()=>{login.$refs.loginBox.sendSMS()}),50)),this.disabled=!1,this.close()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.disabled=!1})))}},watch:{show(t){if(t&&"normal"==b2_global.check_type&&this.change(),t&&!this.issetLuo&&3!=login.loginType){let t=document.createElement("script");t.id="luosimao",t.type="text/javascript",t.src="//captcha.luosimao.com/static/dist/api.js?time="+(new Date).getTime(),document.getElementsByTagName("head")[0].appendChild(t),this.issetLuo=!0}else t&&this.issetLuo&&3!=login.loginType&&LUOCAPTCHA&&LUOCAPTCHA.reset();"edit"!=this.type&&(this.loginType=login.loginType)},recaptcha(t){4==t.length?this.disabled=!1:this.disabled=!0}}});var recaptcha=new Vue({el:"#recaptcha-form",data:{show:!1,type:""},methods:{close(){this.show=!1,"edit"!=this.type&&"bind"!=this.type&&(login.show=!0),"bind"===this.type&&(b2bindLogin.show=!0)}}});function indexPostModules(){let t=document.querySelectorAll(".post-list");if(t.length>0)for(let e=0;e<t.length;e++){let s=t[e].getAttribute("data-key");"undefined"!=t[e].id&&new Vue({el:"#post-item-"+s,data:{key:0,index:0,box:"",paged:1,pages:0,type:"cat",showButton:!1,locked:!1,cat:[],finish:!1,id:0},mounted(){this.$el.querySelector(".load-more")&&(this.key=s,this.index=this.$el.getAttribute("data-i"),this.box=this.$el.querySelectorAll(".b2_gap")[0],this.showButton=this.$el.querySelector(".load-more").getAttribute("data-showButton"))},methods:{getList(t,e,s){if(this.finish&&"more"==e)return;if(this.finish=!1,this.locked)return;this.locked=!0,this.id=t,e&&(this.type=e),"cat"==this.type?(this.paged=1,this.cat=t?[t]:[],this.finish=!1):this.paged=this.paged+1;let i={index:this.index,id:this.cat,post_paged:this.paged};axios.post(b2_rest_url+"getModulePostList",Qs.stringify(i)).then((t=>{t.data.count>0?(this.pages=t.data.pages,"cat"==this.type?(this.pages,this.box.innerHTML=t.data.data,"post-2"==s&&b2PackeryLoad(),this.showButton=!0):"more"==this.type&&(this.box.insertAdjacentHTML("beforeend",t.data.data),"post-2"==s&&b2PackeryLoad(),this.showButton=!0),this.paged>=this.pages&&(this.finish=!0)):(this.box.innerHTML="post-6"==s?'<tr><td colspan="10" style="border:0">'+b2_global.empty_page+"</td></tr>":b2_global.empty_page,this.showButton=!1),this.locked=!1,b2SidebarSticky()}))}}})}}function listFadein(t,e){}function b2PackeryLoad(t){var e=document.querySelectorAll(".grid");if(e.length>0)for(let t=0;t<e.length;t++){new Packery(e[t]).on("layoutComplete",(()=>{b2SidebarSticky()}))}}function b2RestTimeAgo(t){b2Timeago.render(t,"zh_CN")}indexPostModules(),listFadein(document.querySelectorAll(".post-list ul.b2_gap > li"),10),b2PackeryLoad(),Vue.component("pagenav-new",{props:["type","paged","pages","opt","api"],template:b2_global.page_nav,data:function(){return{locked:!1,next:!1,per:!1,cpage:0,cpaged:1,cpages:[],mobile:!1}},created(){window.addEventListener("scroll",this.autoLoadMore),this.cpaged=parseInt(this.paged),this.cpages=this.pagesInit(),window.addEventListener("popstate",(()=>{let t=history.state;t&&t.page&&"p"==this.type&&this.go(t.page)})),this.mobile=!(B2ClientWidth>768)},methods:{disabled(t){return t==this.cpaged&&1==this.locked},pagesInit(){let t=[];if(this.pages<=6)for(let e=1;e<=this.pages;e++)t.push(e);else if(this.cpaged||(this.cpaged=this.paged),this.cpaged<4){for(let e=1;e<=this.pages&&!(e>=5);e++)t.push(e);t.push(0,this.pages)}else if(this.cpaged>=4&&this.pages-2>this.cpaged){t.push(1,0);for(let e=this.cpaged-1;e<=this.cpaged+1;e++)t.push(e);t.push(0,this.pages)}else if(this.pages-2<=this.cpaged){t.push(1,0);for(let e=this.cpaged-2;e<=this.pages;e++)t.push(e)}return t},autoLoadMore(){if("p"==this.type)return;document.documentElement.scrollTop+window.innerHeight>=document.body.clientHeight-550&&this.go(this.cpaged+1)},go(t,e,s){t=parseInt(t),this.opt.length>0||(this.cpaged!=t||s)&&1!=this.locked&&(this.locked=!0,"m"===this.type&&this.pages<=this.cpaged&&1!=t||("next"==e?(this.next=!0,this.per=!1):"per"==e&&(this.per=!0,this.next=!1),this.cpaged=t,this.opt.post_paged=t,this.opt.paged=t,this.$http.post(b2_rest_url+this.api,Qs.stringify(this.opt)).then((t=>{this.locked=!1,this.cpages=this.pagesInit(),this.$emit("return",t.data),b2SidebarSticky(),"undefined"!=typeof b2CommentList&&b2CommentList.$refs.commentPageNav&&b2CommentList.lazyLoadInstance.update(),lazyLoadInstance.update()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0})}))))},getData(t,e){this.cpaged=this.cpage,this.cpages=this.pagesInit()},jump:function(t){var e=t.target.value||t.target.previousElementSibling.value;e>this.pages||this.go(parseInt(e))}},watch:{pages:function(t){this.cpages=this.pagesInit()},paged:function(){this.cpaged=parseInt(this.paged),this.cpages=this.pagesInit()}}}),Vue.component("page-nav",{props:["paged","navtype","pages","type","box","opt","api","url","title"],template:b2_global.page_nav,data:function(){return{locked:!1,next:!1,per:!1,cpage:0,cpaged:1,cpages:[],mobile:!1}},created(){window.addEventListener("scroll",this.autoLoadMore),this.cpaged=parseInt(this.paged),this.cpages=this.pagesInit(),window.addEventListener("popstate",(()=>{let t=history.state;t&&t.page&&"p"==this.type&&this.go(t.page)})),this.mobile=!(B2ClientWidth>768)},methods:{disabled(t){return t==this.cpaged&&1==this.locked},pagesInit(){let t=[];if(this.pages<=7)for(let e=1;e<=this.pages;e++)t.push(e);else if(this.cpaged||(this.cpaged=this.paged),this.cpaged<5){for(let e=1;e<=this.pages&&!(e>=6);e++)t.push(e);t.push(0,this.pages)}else if(this.cpaged>=5&&this.pages-3>this.cpaged){t.push(1,0);for(let e=this.cpaged-2;e<=this.cpaged+2;e++)t.push(e);t.push(0,this.pages)}else if(this.pages-3<=this.cpaged){t.push(1,0);for(let e=this.cpaged-3;e<=this.pages;e++)t.push(e)}return t},autoLoadMore(){setTimeout((()=>{if("p"==this.type)return;document.documentElement.scrollTop+window.innerHeight>=document.body.clientHeight-550&&this.go(this.cpaged+1)}),300)},go(t,e,s){t=parseInt(t),this.opt.length>0||(this.cpaged!=t||s)&&1!=this.locked&&("m"===this.type&&this.pages<=this.cpaged&&1!=t||(this.locked=!0,"next"==e?(this.next=!0,this.per=!1):"per"==e&&(this.per=!0,this.next=!1),this.cpaged=t,this.opt.post_paged=t,this.opt.paged=t,this.$http.post(b2_rest_url+this.api,Qs.stringify(this.opt)).then((e=>{this.locked=!1,this.cpages=this.pagesInit();let s=document.querySelector(this.box);if("json"===this.navtype?this.$emit("return",e.data):"p"===this.type?s.innerHTML=e.data.data:s.insertAdjacentHTML("beforeend",e.data.data),1!=t&&(this.url=b2removeURLParameter(this.url,"action")),window.history&&history.pushState&&(1!=t?"comment"===this.navtype?b2_global.structure?window.history.pushState({page:t},null,this.url+"/comment-page-"+t+"#comment"):window.history.pushState({page:t},null,this.url+"&cpage="+t+"#comment"):("authorComments"!=this.navtype&&this.title&&(document.title=this.title+" "+b2_global.site_separator+" "+b2_global.page_title.replace("{#}",t)+" "+b2_global.site_separator+" "+b2_global.site_name),window.history.pushState({page:t},null,("/"==this.url.substring(this.url.length-1)?this.url:this.url+"/")+"page/"+t)):"comment"===this.navtype?window.history.pushState({page:t},null,this.url+"#comment"):("authorComments"!=this.navtype&&this.title&&(document.title=this.title+" "+b2_global.site_separator+" "+b2_global.site_name),window.history.pushState({page:t},null,this.url)),$("img").lazyload({effect:"fadeIn"})),"comment"===this.navtype||"authorComments"===this.navtype){let t=document.querySelectorAll(".comment-img-box img");if(t.length>0)for(let e=0;e<t.length;e++)b2zoom.listen(t[e]);"comment"===this.navtype&&(b2CommentList.showSticky(),b2SidebarSticky())}else"post"===this.navtype&&(b2PackeryLoad(),setTimeout((()=>{listFadein(document.querySelectorAll(this.box+" > li"),20)}),500));b2SidebarSticky(),"undefined"!=typeof b2CommentList&&b2CommentList.$refs.commentPageNav&&b2CommentList.lazyLoadInstance.update(),lazyLoadInstance.update()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0})}))))},getData(t,e){this.cpaged=this.cpage,this.cpages=this.pagesInit()},jump:function(t){var e=t.target.value||t.target.previousElementSibling.value;e>this.pages||this.go(parseInt(e))}},watch:{pages:function(t){this.cpages=this.pagesInit()},paged:function(){this.cpaged=parseInt(this.paged),this.cpages=this.pagesInit()}}});let pageNavBox=new Vue({el:".post-nav",data:{selecter:"#post-list .b2_gap",opt:"",api:"getPostList",options:[],value:1},mounted(){"undefined"!=typeof b2_cat&&(this.opt=b2_cat.opt)},methods:{jump(t){}}}),b2Audio=new Vue({el:".b2-audio-content",data:{url:"",textList:[],playStatus:!1,api:"https://tts.baidu.com/text2audio?lan=zh&ie=UTF-8&text=",index:0,currentTime:"00:00",startTime:"00:00",step:0,duration:0,ds:"",width:"0%"},methods:{play(){this.url?this.playList():this.getPlayList()},getPlayList(){this.$https.post(b2_rest_url+"getPostAudio","post_id="+this.$refs.audio.getAttribute("data-id")).then((t=>{t.data.length>0&&(this.textList=t.data,this.playList(),this.watchPlay())}))},playList(){this.url=this.api+this.textList[this.index],setTimeout((()=>{this.button()}))},watchPlay(){this.$refs.audio.addEventListener("ended",(()=>{if(this.index>=this.textList.length-1)return this.playStatus=!1,this.index=0,void(this.step=0);this.step=0,this.index=this.index+1,this.playList()}))},button(){null!==this.$refs.audio&&(this.$refs.audio.paused?(this.$refs.audio.play(),this.playStatus=!0,this.timeSetp()):(this.$refs.audio.pause(),this.playStatus=!1),this.$refs.audio.addEventListener("loadedmetadata",(()=>{this.duration=Math.round(this.$refs.audio.duration),this.currentTime=this.secondToDate(this.duration)})))},timeSetp(){1==this.playStatus&&(this.startTime=this.secondToDate(this.step++),this.ds&&clearTimeout(this.ds),this.ds=setTimeout((()=>{this.timeSetp(),this.width=this.step/this.duration*100+"%"}),1e3))},secondToDate(t){var e;if(t>-1){var s=Math.floor(t/3600),i=Math.floor(t/60)%60,o=t%60;e=s>1?s<10?"0"+s+":":s+":":"",i<10&&(e+="0"),e+=i+":",o<10&&(e+="0"),e+=o.toFixed(0)}return e}}});var socialBox=new Vue({el:"#social-box",data:{locked:!1,type:"",data:{token:"",invitation:"",subType:""},error:"",oauth:"",name:""},mounted(){if(this.$refs.socialBox){let t=b2GetQueryVariable("code");this.type=b2GetQueryVariable("type"),t&&(this.locked=!0,this.$http.post(b2_rest_url+"socialLogin","code="+t+"&type="+this.type).then((t=>{this.locked=!1,!0===t.data?this.back():"invitation"==t.data.type?(this.type="invitation",this.data.token=t.data.token):this.back()})).catch((t=>{t.response.data.message.msg?(this.oauth=t.response.data.message.oauth,this.error=t.response.data.message.msg,this.name=t.response.data.message.name):this.error=t.response.data.message,this.locked=!1})))}},methods:{back(){let t=b2getCookie("b2_back_url");window.location.href=t||b2_global.home_url},invRegeister(t){"pass"!=this.locked&&"sub"!=this.locked&&(this.locked=t,this.data.subType=t,this.$http.post(b2_rest_url+"invRegeister",Qs.stringify(this.data)).then((t=>{this.back()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))},loginOut(){userTools.loginOut()},rebuild(t){this.$http.post(b2_rest_url+"unBuild","type="+this.type+"&user_id="+b2_author.author_id).then((t=>{})).catch((e=>{t.preventDefault(),Qmsg.warning(e.response.data.message,{html:!0})}))}}});Vue.component("gg-box",{props:["show"],template:b2_global.gg_box,computed:{ggdata(){return this.$store.state.announcement[0]}},methods:{close(){this.$emit("close")}}});var b2GG=new Vue({el:"#gg-box",data:{show:!1},mounted(){this.$http.post(b2_rest_url+"getLatestAnnouncement","count=3").then((t=>{t.data.length>0?(this.$store.commit("setAnnouncement",t.data),this.show=t.data[0].show):this.$store.commit("setAnnouncement","none")}))},methods:{close(){this.show=!1;let t=(new Date).getTime();t=parseInt(t/1e3),b2setCookie("gg_info",t)}}});Vue.component("dmsg-box",{props:["show","userid","type"],template:b2_global.dmsg_box,data:()=>({user:[],content:"",locked:!1,nickname:"",UserList:[],search:!1}),methods:{close(){this.$emit("close"),setTimeout((()=>{this.user=[],this.content="",this.nickname="",this.UserList=[]}),100)},getUserData(t=0){t=t||this.userid,this.$http.post(b2_rest_url+"getUserPublicData","user_id="+t).then((e=>{this.user=e.data,b2Dmsg.userid=t,b2Dmsg.select="",this.UserList=[]})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0})}))},edit(){b2Dmsg.select="select"},send(){1!=this.locked&&(this.locked=!0,this.$http.post(b2_rest_url+"sendDirectmessage","user_id="+this.userid+"&content="+this.content).then((t=>{1==t.data&&this.close(),b2DmsgPage.$refs.dmsgPage&&b2DmsgPage.getList(),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))},searchUser(t){1!=this.locked&&(this.locked=!0,this.search=!0,this.$http.post(b2_rest_url+"searchUsers","nickname="+t).then((t=>{t.data.length>0?this.UserList=t.data:this.UserList=[],this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1,this.UserList=[]})))}},watch:{show(t){t&&"select"!==this.type&&this.getUserData()},nickname(t){t&&this.searchUser(t)}}});var b2Dmsg=new Vue({el:"#dmsg-box",data:{userid:0,show:!1,select:""},methods:{close(){this.show=!this.show}}}),b2DmsgPage=new Vue({el:".dmsg-page",data:{list:!1,locked:!1,count:0,pages:0,selecter:".dmsg-header",opt:{paged:1},api:"getUserDirectmessageList"},mounted(){this.$refs.dmsgPage&&(this.opt.paged=this.$refs.dmsgPage.getAttribute("data-paged"),this.getList())},methods:{getList(){this.$http.post(b2_rest_url+"getUserDirectmessageList",Qs.stringify(this.opt)).then((t=>{this.list=t.data.data,this.pages=t.data.count,this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))},showDmsgBox(){b2Dmsg.select="select",b2Dmsg.show=!0},get(t){this.list=t.data,this.pages=t.count},jump(t){window.location.href=this.$refs.dmsgPage.getAttribute("data-url")+"/to/"+t},deleteDmsg(t){}}}),b2dmsgPageTo=new Vue({el:".dmsg-page-to",data:{list:!1,locked:!1,opt:{paged:1,userid:0},count:0,pages:0,selecter:".dmsg-header",api:"getMyDirectmessageList",content:"",sendLocked:!1},mounted(){this.$refs.mydmsg&&(this.opt.userid=this.$refs.mydmsg.getAttribute("data-id"),this.opt.paged=this.$refs.mydmsg.getAttribute("data-paged"),this.getList())},methods:{getList(){this.$http.post(b2_rest_url+"getMyDirectmessageList",Qs.stringify(this.opt)).then((t=>{this.list=t.data.data,this.locked=!1,this.count=t.data.count,this.pages=t.data.pages})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))},get(t){this.list=t.data,this.count=t.count,this.pages=t.pages},send(){1!=this.sendLocked&&(this.sendLocked=!0,this.$http.post(b2_rest_url+"sendDirectmessage","user_id="+this.opt.userid+"&content="+this.content).then((t=>{this.getList(),this.content="",this.sendLocked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.sendLocked=!1})))}}}),b2DownloadPage=new Vue({el:"#download-page",data:{data:"",postId:0,index:0,i:0},mounted(){if(this.$refs.downloadPage){this.postId=b2GetQueryVariable("post_id"),this.index=b2GetQueryVariable("index"),this.i=b2GetQueryVariable("i"),this.getData();var t=new ClipboardJS(".fuzhi");t.on("success",(t=>{Qmsg.success(b2_global.js_text.global.copy_success,{html:!0})})),t.on("error",(t=>{Qmsg.warning(b2_global.js_text.global.copy_select,{html:!0})}))}},methods:{getData(){let t=b2getCookie("b2_guest_buy_"+this.postId+"_x");t&&(t=JSON.parse(t));let e={post_id:this.postId,index:this.index,i:this.i,guest:t};this.$http.post(b2_rest_url+"getDownloadPageData",Qs.stringify(e)).then((t=>{this.data=t.data})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0})}))},login(){login.show=!0}}});Vue.component("check-box",{props:["show","title","type","payt"],template:b2_global.pay_check,data:()=>({success:!1,timeOut:300,timesec:"",sTime:"",check:!1,checkTime:""}),methods:{close(){this.$emit("close"),this.sTime="",this.checkTime=""},checkAc(){if(null===this.sTime&&"fail"==this.success||null===this.checkTime||!0===this.success)return void(this.checkTime=null);let t=b2getCookie("order_id");this.$http.post(b2_rest_url+"payCheck","order_id="+t).then((e=>{if("success"===e.data.status){if(!b2token){let s=b2getCookie("b2_guest_buy_"+e.data.id+"_"+e.data.type);s=s?JSON.parse(s):new Object,Reflect.set(s,e.data.index,{id:e.data.id,order_id:t,type:e.data.type,index:e.data.index}),s=JSON.stringify(s),b2setCookie("b2_guest_buy_"+e.data.id+"_"+e.data.type,s)}"undefined"!=typeof B2VerifyPage?(B2VerifyPage.data.money=!0,this.close()):"undefined"!=typeof carts?(carts.step=3,this.close()):"ask"===this.payt?(b2CircleList.afterCommentGetData(b2CircleList.answer.listParent,b2CircleList.data[b2CircleList.answer.listParent].topic_id,"ask"),this.close()):"hidden"===this.payt&&(b2CircleList.afterCommentGetData(b2CircleList.hiddenIndex,b2CircleList.data[b2CircleList.hiddenIndex].topic_id,"hidden"),this.close()),this.success=!0,this.checkTime=null,this.sTime=null}else this.checkTime=setTimeout((()=>{this.checkAc()}),1e3)}))},time(){this.currTime=parseInt(Date.parse(new Date)/1e3),this.endTime=parseInt(this.currTime+this.timeOut),this.setTime()},setTime(){if(0==this.show||!0===this.success)return this.sTime=null,void(this.checkTime=null);let t=parseInt(this.endTime-this.currTime),e=Math.floor(t/60%60),s=Math.floor(t%60);this.timesec=(e>0?e+"<b>"+b2_global.js_text.global.min+"</b>":"")+s+"<b>"+b2_global.js_text.global.sec+"</b>",t>0?this.sTime=setTimeout((()=>{this.endTime=this.endTime-1,this.setTime()}),1e3):(this.sTime=null,this.success="fail")},refresh(){if("undefined"!=typeof B2VerifyPage)B2VerifyPage.data.money=!0,this.close();else if("undefined"!=typeof carts)carts.step=3,this.close();else if("ask"===this.payt)b2CircleList.afterCommentGetData(b2CircleList.answer.listParent,b2CircleList.data[b2CircleList.answer.listParent].topic_id,"ask"),this.close();else if("hidden"===this.payt)b2CircleList.afterCommentGetData(b2CircleList.hiddenIndex,b2CircleList.data[b2CircleList.hiddenIndex].topic_id,"hidden"),this.close();else{var t=new URL(window.location.href);t.searchParams.delete("b2paystatus"),window.location.href=t.href}}},watch:{show(t){"card"!=this.type&&(t?(this.sTime="",this.checkTime="",this.time(),this.checkAc()):(this.sTime=null,this.success=!1,this.checkTime=null))}}});var b2PayCheck=new Vue({el:"#pay-check",data:{show:!1,title:"",type:"",payType:""},mounted(){"check"==b2GetQueryVariable("b2paystatus")&&(this.show=!0)},methods:{close(){this.show=!this.show,this.show||(this.payType="")}}}),b2Pay=new Vue({el:"#pay-page",data:{data:[],token:"",error:"",locked:!1,payUrl:""},mounted(){this.$refs.payPage&&(this.token=this.$refs.payPage.getAttribute("data-token"),this.token||(this.data=JSON.parse(this.$refs.payPage.getAttribute("data-pay")),this.pay()))},methods:{pay(){1!=this.locked&&(this.locked=!0,this.$http.post(b2_rest_url+"buildOrder",Qs.stringify(this.data)).then((t=>{this.token=t.data,this.payUrl=window.location.href.split("?")[0]+"?token="+this.token,this.locked=!1})).catch((t=>{this.error=t.response.data.message,this.locked=!1})))}}});function b2MakeForm(t,e){var s=document.createElement("form");s.id="form1",s.name="form1",document.body.appendChild(s);var i=document.createElement("input");i.name="token",i.value=e,s.appendChild(i),s.method="POST",s.action=t,s.submit(),document.body.removeChild(s)}Vue.component("scan-box",{props:["show","data"],template:b2_global.scan_box,data:()=>({locked:!1,qrcode:"",timeOut:300,timesec:"",sTime:"",success:"",checkTime:"",backData:[]}),methods:{close(){this.$emit("close"),this.backData=[],this.checkTime=null},buildOrder(){1!=this.locked&&(this.locked=!0,this.currTime=parseInt(Date.parse(new Date)/1e3),this.endTime=parseInt(this.currTime+this.timeOut),this.setTime(),this.$http.post(b2_rest_url+"buildOrder",Qs.stringify(this.data)).then((t=>{if(this.backData=t.data,"mapay"!==t.data.type&&"pay020"!==t.data.type){var e=new QRious({value:this.backData.qrcode,size:200,level:"L"});this.backData.qrcode=e.toDataURL("image/jpeg")}this.writeOrder(t.data.order_id),this.locked=!1,this.checkAc()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))},writeOrder(t){b2setCookie("order_id",t)},checkAc(){if(null===this.sTime&&"fail"==this.success||null===this.checkTime||0==this.show)return void(this.checkTime=null);let t=b2getCookie("order_id");this.$http.post(b2_rest_url+"payCheck","order_id="+t).then((e=>{if("success"===e.data.status){if(!b2token){let s=b2getCookie("b2_guest_buy_"+e.data.id+"_"+e.data.type);s=s?JSON.parse(s):new Object,Reflect.set(s,e.data.index,{id:e.data.id,order_id:t,type:e.data.type,index:e.data.index}),s=JSON.stringify(s),b2setCookie("b2_guest_buy_"+e.data.id+"_"+e.data.type,s)}this.success=!0,this.checkTime=null,"undefined"!=typeof B2VerifyPage&&(B2VerifyPage.data.money=!0,this.close()),"undefined"!=typeof carts&&(carts.step=3,this.close()),"circle_read_answer_pay"===this.data.order_type&&(b2CircleList.afterCommentGetData(b2CircleList.answer.listParent,b2CircleList.data[b2CircleList.answer.listParent].topic_id,"ask"),this.close()),"circle_hidden_content_pay"===this.data.order_type&&(b2CircleList.afterCommentGetData(b2CircleList.hiddenIndex,b2CircleList.data[b2CircleList.hiddenIndex].topic_id,"hidden"),this.close())}else this.checkTime=setTimeout((()=>{this.checkAc()}),1e3)}))},setTime(){if(0==this.show)return;let t=parseInt(this.endTime-this.currTime),e=Math.floor(t/60%60),s=Math.floor(t%60);this.timesec=(e>0?e+"<b>"+b2_global.js_text.global.min+"</b>":"")+s+"<b>"+b2_global.js_text.global.sec+"</b>",t>0?this.sTime=setTimeout((()=>{this.endTime=this.endTime-1,this.setTime()}),1e3):(this.sTime=null,this.success="fail")},refresh(){"circle_read_answer_pay"===this.data.order_type?(b2CircleList.afterCommentGetData(b2CircleList.answer.listParent,b2CircleList.data[b2CircleList.answer.listParent].topic_id,"ask"),this.close()):"circle_hidden_content_pay"===this.data.order_type?(b2CircleList.afterCommentGetData(b2CircleList.hiddenIndex,b2CircleList.data[b2CircleList.hiddenIndex].topic_id,"hidden"),this.close()):location.reload()}},watch:{show(t){t?(this.sTime="",this.success=!1,this.checkTime=""):(this.sTime=null,this.success=!1,this.checkTime=null)},data:{deep:!0,handler(t,e){this.buildOrder()}}}});var b2ScanPay=new Vue({el:"#scan-box",data:{data:[],show:!1},methods:{close(){this.show=!this.show}}});Vue.component("ds-box",{props:["show","money","msg","user","author","data","showtype"],template:b2_global.ds_box,data:()=>({value:0,custom:0,content:"",payType:"",payMoney:"",locked:!1,jump:"",href:"",isWeixin:"",isMobile:"",allow:[],card:[],cg:[],newWin:null,login:!1,redirect:"",payData:""}),created(){this.isWeixin=b2isWeixin(),b2token&&(this.login=!0),this.redirect=b2getCookie("b2_back_url")},methods:{close(){this.$emit("close"),this.locked=!1},clean(){this.$emit("clean")},picked(t,e){this.value=e,this.payMoney=t},post(t,e){var s=document.createElement("form");return s.action=t,s.method="post",s.target="_blank",s.style.display="none",Object.keys(e).length>0&&Object.keys(e).forEach((t=>{var i=document.createElement("input");i.name=t,i.value=e[t],s.appendChild(i)})),document.body.appendChild(s),s.submit(),s},restData(t=[]){(t="ds"==this.showtype?Object.assign(t,{title:this.$refs.dstitle.innerText,order_price:this.payMoney,order_type:"ds",post_id:b2_global.post_id,pay_type:this.payType,order_content:this.content}):"cz"==this.showtype?{title:b2_global.js_text.global.pay_money,order_price:this.payMoney,order_type:"cz",post_id:0,pay_type:this.payType}:"cg"==this.showtype?{title:b2_global.js_text.global.pay_credit,order_price:this.payMoney,order_type:"cg",post_id:0,pay_type:this.payType}:Object.assign(this.data,t)).pay_type=this.payType;var e=new URL(window.location.href);return e.searchParams.set("b2paystatus","check"),t.redirect_url=e.href,t},disabled(){if("card"!==this.data.pay_type){if(""==this.jump)return!0;if(("jump"==this.jump||"mweb"==this.jump||"jsapi"==this.jump)&&""==this.href&&""==this.payData)return!0;if(1==this.locked)return!0;if(""==this.payType)return!0;if(""===this.payMoney)return!0}else if(!this.card.number||!this.card.password)return!0;return!1},chosePayType(t){1!=this.locked&&(this.locked=!0,this.payType=t,this.href="",this.payData="",this.jump="",this.$http.post(b2_rest_url+"checkPayType","pay_type="+t).then((t=>{if("card"==t.data.pay_type)this.$emit("change","card"),this.card.text=t.data.card_text,this.jump=t.data.pay_type,this.locked=!1;else if("card"==this.showtype&&this.$emit("change","cz"),this.jump=t.data.pay_type,this.isMobile=t.data.is_mobile,"jump"==this.jump||"mweb"===this.jump||"jsapi"===this.jump){let t=Qs.stringify(this.restData());this.$http.post(b2_rest_url+"buildOrder",t).then((t=>{this.writeOrder(t.data.id),"string"==typeof t.data.url?this.href=t.data.url:this.payData=t.data.url,this.locked=!1})).catch((t=>{"bind_weixin"===t.response.data.message.msg?(b2setCookie("b2_back_url",window.location.href),"string"==typeof t.response.data.message.oauth?(b2weixinBind.msg=t.response.data.message.oauth,b2weixinBind.show=!0):(b2weixinBind.show=!0,b2weixinBind.url=t.response.data.message.oauth.weixin.url)):Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}else this.locked=!1;b2setCookie("b2_back_url",window.location.href)})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))},writeOrder(t){b2setCookie("order_id",t)},balancePay(t){let e=this.restData();this.$http.post(b2_rest_url+"balancePay","order_id="+t).then((t=>{this.close(),b2PayCheck.show=!0,b2PayCheck.title=e.title,this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))},pay(){if(!this.disabled())if("card"===this.jump){if(1==this.locked)return;this.locked=!0,this.$http.post(b2_rest_url+"cardPay",Qs.stringify(this.card)).then((t=>{"success"===t.data&&(b2PayCheck.show=!0,b2PayCheck.title=b2_global.js_text.global.pay_money_success,b2PayCheck.type="card",this.close()),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}else if("jump"===this.jump||"mweb"===this.jump)b2PayCheck.show=!0,b2PayCheck.title=this.$refs.dstitle.innerHTML,this.close(),this.payData&&this.post(this.payData.url,this.payData.data);else if("balance"===this.jump){if(1==this.locked)return;this.locked=!0;let t=Qs.stringify(this.restData());this.$http.post(b2_rest_url+"buildOrder",t).then((t=>{this.writeOrder(t.data),this.balancePay(t.data)})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}else if("scan"===this.jump)this.isMobile?b2ScanPay.data=this.restData({is_weixin:this.isWeixin,is_mobile:this.isMobile}):b2ScanPay.data=this.restData(),b2ScanPay.show=!0,this.close();else if("jsapi"===this.jump){let t=this.restData();jsApiCall(this.payData),this.close(),b2PayCheck.show=!0,b2PayCheck.title=t.title}},allowPayType(){this.$http.post(b2_rest_url+"allowPayType","show_type="+this.showtype).then((t=>{this.allow=t.data,this.user.money=t.data.money,t.data.dh&&(this.cg.min=t.data.min,this.cg.dh=t.data.dh,this.payMoney=this.cg.min)}))},creditAdd(){return parseInt(this.payMoney*this.cg.dh)}},watch:{money(t){0==this.payMoney&&(this.payMoney=t[0])},show(t){t&&(b2setCookie("b2_back_url",window.location.href),this.allowPayType()),t&&this.money.length>0?this.payMoney=this.money[0]:t&&0!=this.data.length?this.payMoney=this.data.order_price:0==t&&setTimeout((()=>{this.value=0,this.payMoney=0,this.payType="",this.clean()}),300)},payType(t){this.data.pay_type=t},showtype(t){}}});var b2DsBox=new Vue({el:"#ds-box",data:{money:[],show:!1,msg:"",user:[],author:[],data:[],showtype:""},methods:{close(){this.show=!this.show},clean(){this.data=[],this.money=[]},change(t){this.showtype=t}}}),b2Ds=new Vue({el:"#content-ds",data:{data:""},methods:{show(){b2DsBox.money=this.data.moneys,b2DsBox.show=!0,b2DsBox.showtype="ds",b2DsBox.msg=this.data.single_post_ds_text}}});function b2pay(t){let e=JSON.parse(t.getAttribute("data-pay"));b2DsBox.data=e,b2DsBox.show=!0,b2DsBox.showtype="normal"}function b2creditpay(t){if(b2token){let e=JSON.parse(t.getAttribute("data-pay"));payCredit.data=e,payCredit.show=!0}else login.show=!0}function uuid(t,e){var s,i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(e=e||o.length,t)for(s=0;s<t;s++)a[s]=o[0|Math.random()*e];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",s=0;s<36;s++)a[s]||(i=0|16*Math.random(),a[s]=o[19==s?3&i|8:i]);return a.join("")}function openWin(t,e,s,i){var o=(window.screen.availHeight-30-i)/2,a=(window.screen.availWidth-10-s)/2;window.open(t,e,"height="+i+",innerHeight="+i+",width="+s+",innerWidth="+s+",top="+o+",left="+a+",status=no,toolbar=no,menubar=no,location=no,resizable=no,scrollbars=0,titlebar=no")}function deleteHtmlTag(t){return t=t.replace(/<[^>]+>|&[^>]+;/g,"").trim()}var b2cache=[];function b2addJs(t,e){for(var s=0,i=b2cache.length;i--;)s=b2cache[i]==t?1:0;if(!s){var o=document.getElementsByTagName("head")[0],a=document.createElement("script");a.src=t,a.type="text/javascript",o.appendChild(a),a.onload=a.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(a.onload=a.onreadystatechange=null,e())},b2cache.push(t)}}function jsApiCall(t){WeixinJSBridge.invoke("getBrandWCPayRequest",t,(function(t){}))}function callpay(){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",jsApiCall,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",jsApiCall),document.attachEvent("onWeixinJSBridgeReady",jsApiCall)):jsApiCall()}function b2SidebarSticky(){if(B2ClientWidth<=768)return;if(document.querySelector(".post-style-5"))return;if(void 0!==window.b2Stick){for(let t=0;t<window.b2Stick.length;t++)window.b2Stick[t]&&window.b2Stick[t].updateSticky();return}let t=document.querySelectorAll(".sidebar");if(t&&B2ClientWidth>768){var e=[];for(let s=0;s<t.length;s++)t[s].querySelector(".widget-ffixed")&&(e[s]=new StickySidebar(t[s],{containerSelector:".widget-area",topSpacing:20,resizeSensor:!0,bottomSpacing:20}));window.b2Stick=e}}Vue.component("credit-box",{props:["show","data","user"],template:b2_global.credit_box,data:()=>({locked:!1}),methods:{close(){this.$emit("close")},writeOrder(t){b2setCookie("order_id",t)},disabled(){return!0===this.locked||parseInt(this.user.credit)<parseInt(this.data.order_price)},creditPay(t){this.writeOrder(t),this.$http.post(b2_rest_url+"creditPay","order_id="+t).then((t=>{this.locked=!1,b2PayCheck.show=!0,this.close()})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))},pay(){if(1==this.locked)return;this.locked=!0,this.data.pay_type="credit";let t=Qs.stringify(this.data);this.$http.post(b2_rest_url+"buildOrder",t).then((t=>{this.creditPay(t.data)})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}}});var payCredit=new Vue({el:"#credit-box",data:{show:!1,data:[],user:{credit:0},author:[]},methods:{close(){this.show=!this.show}}}),B2UserWidget=new Vue({el:".b2-widget-user",data:{show:!1,b2token:!1},mounted(){this.b2token=b2token},computed:{userData(){return this.$store.state.userData},oauth(){return this.$store.state.oauthLink},announcement(){return this.$store.state.announcement},openOauth(){return this.$store.state.openOauth}},watch:{announcement(t){t&&!this.show&&this.resize()}},methods:{resize(){this.$nextTick((()=>{this.$refs.userWidget&&(this.$refs.gujia&&(this.$refs.gujia.style.display="none"),setTimeout((()=>{b2tooltip(".user-w-tips")}),300),this.show=!0)}))},markHistory(t){this.oauth.weixin.mp&&"weixin"===t&&(mpCode.show=!0),b2setCookie("b2_back_url",window.location.href)}}}),b2Mission=new Vue({el:".b2-widget-mission",data:{data:"",locked:!1,type:"today",paged:1,pages:{today:1,always:1}},mounted(){this.$refs.missionWidget&&this.getData()},methods:{getData(t,e){this.$refs.missionWidget&&(t=this.$refs.missionWidget.getAttribute("data-count")),e&&(this.paged=e),this.$http.post(b2_rest_url+"getUserMission","count="+t+"&paged="+this.paged).then((t=>{this.data=t.data,this.pages.today=t.data.mission_today_list.pages,this.pages.always=t.data.mission_always_list.pages,this.$refs.missiongujia&&(this.$refs.missiongujia.style.display="none")}))},mission(){if(b2token){if(this.data.mission.credit)return void Qmsg.warning(b2_global.js_text.global.has_mission,{html:!0});if(1==this.locked)return;this.locked=!0,this.$http.post(b2_rest_url+"userMission").then((t=>{this.$nextTick((()=>{this.data.mission=t.data.mission,this.locked=!1}))})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}else login.show=!0}}}),b2NewComment=new Vue({el:".b2-widget-comment",data:{data:"",paged:1,pages:1,count:5,hidden:1,next:!1,prev:!1,locked:!1},mounted(){this.$refs.commentWidget&&(this.count=this.$refs.commentWidget.getAttribute("data-count"),this.hidden=this.$refs.commentWidget.getAttribute("data-hidden"),this.getList(),1==this.paged&&(this.prev=!0))},methods:{getList(){1!=this.locked&&(this.locked=!0,this.$https.post(b2_rest_url+"getNewComments","paged="+this.paged+"&count="+this.count+"&hidden="+this.hidden).then((t=>{this.data=t.data.data,this.pages=t.data.pages,this.$refs.gujia&&(this.$refs.gujia.style.display="none"),this.$nextTick((()=>{b2SidebarSticky()})),this.locked=!1})))},nexAc(){this.next||this.locked||(this.paged++,this.getList())},prevAc(){this.prev||this.locked||(this.paged--,this.getList())}},watch:{paged(t){this.prev=t<=1,t>=this.pages?this.next=!0:this.next=!1}}}),b2mobileFooterMenu=new Vue({el:"#mobile-footer-menu",data:{msg:0,show:!0}}),postPoBox=new Vue({el:"#post-po-box",data:{show:!1,login:!1,allow:""},mounted(){b2token&&(this.login=!0)},methods:{close(){this.showPost=!this.showPost},go(t,e){if(!this.login)return login.show=!0,void(login.type=0);"request"==e||userTools.role[e]?setTimeout((()=>{window.location.href=t}),250):Qmsg.warning(b2_global.js_text.global.not_allow,{html:!0})}}}),b2AsideBar=new Vue({el:".aside-container",data:{dmsg:{count:0},msg:{count:0},showBox:!1,showType:{user:!1,msg:!1,dmsg:!1,mission:!1,coupon:!1},locked:!1,mission:[],bool:!1,coupon:{count:0,data:""},showCouponInfo:[],qrcode:"",ref:"",dlocked:!1,count:0,cartLocked:!1,b2token:!1},computed:{userData(){return this.$store.state.userData},carts(){if(this.count&&!this.cartLocked)return{count:this.count,data:""};{let t=this.$store.state.carts;return{count:null!=t?Object.keys(t).length:0,data:t}}}},mounted(){this.b2token=b2token},methods:{getQrcode(t){return(t=new URL(t)).searchParams.set("ref",this.ref),new QRious({value:t.href,size:120,level:"L"}).toDataURL("image/jpeg")},goMyPage(){if(!b2token)return login.show=!0,void(login.type=0);window.location.href=this.userData.link},chat(){"crisp"==b2_global.chat.type&&$crisp.push(["do","chat:open"]),"qq"==b2_global.chat.type&&window.open("http://wpa.qq.com/msgrd?v=3&uin="+b2_global.chat.qq+"&site=qq&menu=yes","_blank"),"dmsg"==b2_global.chat.type&&(b2token?(b2Dmsg.userid=b2_global.chat.dmsg,b2Dmsg.show=!0):login.show=!0),"requests"==b2_global.chat.type&&(b2token?window.open(b2_global.home_url+"/requests","_blank"):login.show=!0)},show(t,e){if(this.closeBox(),"user"===t&&!b2token)return login.show=!0,void(login.type=0);if("dmsg"===t&&0==this.dmsg.count)return b2token?void this.jumpTo(e):(login.show=!0,void(login.type=0));if("msg"===t)return b2token?void this.jumpTo(e):(login.show=!0,void(login.type=0));if("mission"==t&&(this.mission=b2Mission,0==this.mission.data.length&&this.mission.getData(10)),"coupon"===t&&this.getMyCoupons(),"cart"===t){if(!b2token)return login.show=!0,void(login.type=0);this.getMycarts()}this.showType[t]=!0,this.showBox=!0},getMycarts(){1!=this.cartLocked&&(this.cartLocked=!0,this.$http.get(b2_rest_url+"getMyCarts").then((t=>{Object.keys(t.data).length>0&&this.$store.commit("setcartsData",t.data)})))},showAc(t){b2token?t?this.show("user"):this.close():login.show=!0},closeBox(){Object.keys(this.showType).forEach((t=>{this.showType[t]=!1})),this.showBox=!1},getNewDmsg(){if(b2token){if(this.locked)return;this.locked=!0,this.$http.post(b2_rest_url+"getNewDmsg").then((t=>{this.dmsg=t.data.dmsg,topMenuLeft.count=t.data.msg,this.locked=!1}))}},close(){this.$refs.asideContainer&&this.$refs.asideContainer.className.indexOf("aside-show")&&B2ClientWidth<768?(this.$refs.asideContainer.className=this.$refs.asideContainer.className.replace(" aside-show",""),this.showBox=!1):this.closeBox()},goTop(){this.$scrollTo(".site",300,{offset:0})},login(){b2token?this.$refs.asideContent?(this.show("user"),this.$refs.asideContainer.className+=" aside-show"):self.location=this.$store.state.userData.link:login.show=!0},showSearch(){b2SearchBox.close()},jumpTo(t){window.location.href=t},updateCarts(){let t=b2getCookie("carts");this.carts.data=t?JSON.parse(t):"",this.carts.data&&(this.carts.count>Object.keys(this.carts.data).length?b2mobileFooterMenu.msg=b2mobileFooterMenu.msg-(this.carts.count-Object.keys(this.carts.data).length):b2mobileFooterMenu.msg=b2mobileFooterMenu.msg+(Object.keys(this.carts.data).length-this.carts.count),this.carts.count=Object.keys(this.carts.data).length)},deleteCarts(t){this.$https.post(b2_rest_url+"deleteMyCarts","id="+t).then((t=>{0==t.data.length?this.$store.commit("setcartsData",{}):this.$store.commit("setcartsData",t.data)}))},getMyCoupons(){b2token?(this.showType.coupon=!0,this.$https.get(b2_rest_url+"getMyCoupons").then((t=>{this.coupon=t.data}))):login.show=!0},couponClass:t=>t.expiration_date.expired?"stamp04":t.products.length>0?"stamp01":t.cats.length>0?"stamp02":"stamp03",couponMoreInfo(t){this.$set(this.showCouponInfo,t,!this.showCouponInfo[t])},deleteCoupon(t){confirm(b2_global.js_text.global.delete_coupon)&&this.$https.post(b2_rest_url+"deleteMyCoupon","id="+t).then((e=>{this.$delete(this.coupon.data,t),this.$set(this.coupon,"count",this.coupon.count-1)}))}},watch:{userData(t){t&&this.$refs.asideContent&&(b2token&&(this.ref=t.user_code,this.getNewDmsg()),this.updateCarts())},dmsg:{handler(t,e){t.count>0&&(b2mobileFooterMenu.msg+=parseInt(t.count))},immediate:!0,deep:!0},msg:{handler(t,e){t.count>0&&(b2mobileFooterMenu.msg+=parseInt(t.count))},immediate:!0,deep:!0},showBox(t){t&&B2ClientWidth<768&&(this.$refs.asideContainer.className+=" aside-show")}}});function b2HiddenFilterBox(t){t.parentNode.parentNode.className=t.parentNode.parentNode.className.replace("b2-show","")}function b2flickity(){if(!(B2ClientWidth<768)){var t=document.querySelectorAll(".home-collection-silder");if(t){var e=[];for(let s=0;s<t.length;s++){let i,o;e[s]=new Flickity(t[s],{pageDots:!1,groupCells:!0,draggable:!0,prevNextButtons:!1,freeScroll:!1,wrapAround:!0,selectedAttraction:.15,friction:1,freeScrollFriction:.1,cellAlign:"left"}),i=t[s].querySelector(".coll-3-box")?t[s].parentNode.querySelector(".collection-previous"):t[s].parentNode.parentNode.parentNode.querySelector(".collection-previous"),i.addEventListener("click",(function(){e[s].previous()})),o=t[s].querySelector(".coll-3-box")?t[s].parentNode.querySelector(".collection-next"):t[s].parentNode.parentNode.parentNode.querySelector(".collection-next"),o.addEventListener("click",(function(){e[s].next()}))}}}}function b2HiddenFooter(){let t=document.querySelector(".site-footer .site-footer-widget-in");if(!t)return;let e=t.querySelectorAll(".mobile-hidden");e&&e.length>=t.childNodes.length&&(document.querySelector(".site-footer").className+=" mobile-hidden")}b2flickity(),b2HiddenFooter();var b2SearchUser=new Vue({el:"#user-list",data:{follow:[],ids:[]},mounted(){this.$refs.searchUser&&(this.ids=b2_search_data.users,this.checkFollowByids())},methods:{checkFollowByids(){let t={ids:this.ids};this.$http.post(b2_rest_url+"checkFollowByids",Qs.stringify(t)).then((t=>{this.follow=t.data}))},followAc(t){b2token?this.$http.post(b2_rest_url+"AuthorFollow","user_id="+t).then((e=>{this.follow[t]=e.data})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0})})):login.show=!0},dmsg(t){b2token?(b2Dmsg.userid=t,b2Dmsg.show=!0):login.show=!0}}});function b2stmap(){let t=document.querySelectorAll(".stamp");if(t.length>0){let e=axios;b2token&&(e.defaults.headers.common.Authorization="Bearer "+b2token);for(let s=0;s<t.length;s++)t[s].querySelector(".coupon-receive").onclick=t=>{b2token?e.post(b2_rest_url+"ShopCouponReceive","&id="+t.target.getAttribute("data-id")).then((t=>{t.data&&Qmsg.success(b2_global.js_text.global.get_success,{html:!0})})).catch((t=>{Qmsg.success(t.response.data.message,{html:!0})})):login.show=!0},t[s].querySelector(".more-coupon-info").onclick=t=>{t.target.nextElementSibling.style.display="block"},t[s].querySelector(".close-coupon-info").onclick=t=>{t.target.parentNode.parentNode.style.display="none"}}}function b2IsPhoneAvailable(t){return!(!/^1[0-9]{10}/.test(t)&&!/[a-zA-Z0-9]{1,10}@[a-zA-Z0-9]{1,5}\.[a-zA-Z0-9]{1,5}/.test(t))}!function(){var t={Add:function(t,e){t=t.toString(),e=e.toString();var s=t.split("."),i=e.split("."),o=2==s.length?s[1]:"",a=2==i.length?i[1]:"",n=Math.max(o.length,a.length),h=Math.pow(10,n),r=Number(((t*h+e*h)/h).toFixed(n)),d=arguments[2];return"number"==typeof d?Number(r.toFixed(d)):r},Sub:function(t,e){return Calc.Add(t,-Number(e),arguments[2])},Mul:function(t,e){var s,i,o=t.toString(),a=e.toString(),n=arguments[2];return s=(o.split(".")[1]?o.split(".")[1].length:0)+(a.split(".")[1]?a.split(".")[1].length:0),i=Number(o.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,s),Number("number"!=typeof n?i:i.toFixed(parseInt(n)))},Div:function(t,e){var s,i,o=t.toString(),a=e.toString(),n=arguments[2];return s=(a.split(".")[1]?a.split(".")[1].length:0)-(o.split(".")[1]?o.split(".")[1].length:0),i=Number(o.replace(".",""))/Number(a.replace(".",""))*Math.pow(10,s),Number("number"!=typeof n?i:i.toFixed(parseInt(n)))}};window.Calc=t}(),b2stmap();var b2TaxTop=new Vue({el:".tax-header",data:{showFliter:{hot:!1,cat:!1}},methods:{show(t){"hot"===t&&(this.showFliter.hot=!this.showFliter.hot,this.showFliter.cat=!1),"cat"===t&&(this.showFliter.cat=!this.showFliter.cat,this.showFliter.hot=!1)}}});function b2scroll(t){var e=document.documentElement.scrollTop;t=t||function(){};window.bodyScrool=function(){var s=document.documentElement.scrollTop||document.body.scrollTop,i=s-e;if(0===i)return!1;t(i>0?"down":"up",s),e=s},window.addEventListener("scroll",window.bodyScrool,!1)}function b2HeaderTop(){const t=document.querySelector(".header-banner-left"),e=document.querySelector(".site"),s=document.querySelector(".bar-user-info"),i=document.querySelector(".social-top"),o=document.querySelector(".social-no-sub"),a=document.querySelector(".mobile-footer-menu");if(!t)return;let n=96;B2ClientWidth<768&&(n=77),i&&(n=113),o&&(n=58),b2scroll((function(i,o){o>n?("down"===i?(-1===t.className.indexOf(" hidden")&&(t.className+=" hidden"),-1===e.className.indexOf(" up")&&(e.className+=" up"),B2ClientWidth>768&&s&&(s.style="padding-top:"+(n-28)+"px"),a&&B2ClientWidth<768&&-1===a.className.indexOf(" footer-down")&&(a.className+=" footer-down")):(t.className=t.className.replace(" hidden",""),e.className=e.className.replace(" up",""),B2ClientWidth>768&&s&&(s.style="padding-top:"+(n+10)+"px"),a&&B2ClientWidth<768&&(a.className=a.className.replace(" footer-down",""))),-1===e.className.indexOf(" action")&&(e.className+=" action")):(e.className=e.className.replace(" action",""),t.className=t.className.replace(" hidden",""),e.className=e.className.replace(" up",""),s&&(s.style="padding-top:"+(n+10)+"px"))}))}b2HeaderTop();var b2NewsfalshesWidget=new Vue({el:".widget-newsflashes-box",data:{options:[],list:""},mounted(){this.$refs.newsWidget&&(this.options=JSON.parse(this.$refs.newsWidget.getAttribute("data-json")),this.getList())},methods:{getList(){this.$https.post(b2_rest_url+"getWidgetNewsflashes",Qs.stringify(this.options)).then((t=>{this.list=t.data,this.$refs.gujia.style.display="none"}))}}});Vue.component("weixin-bind",{props:["show","url","msg"],template:b2_global.weixin_bind,methods:{close(){this.$emit("close")}}});var b2weixinBind=new Vue({el:"#weixin-bind",data:{show:!1,url:"",msg:""},methods:{close(){this.show=!this.show}}});function b2GetQueryVariable(t){for(var e=window.location.search.substring(1).split("&"),s=0;s<e.length;s++){var i=e[s].split("=");if(i[0]==t)return i[1]}return!1}function b2removeURLParameter(t,e){var s=t.split("?");if(s.length>=2){for(var i=encodeURIComponent(e)+"=",o=s[1].split(/[&;]/g),a=o.length;a-- >0;)-1!==o[a].lastIndexOf(i,0)&&o.splice(a,1);return s[0]+(o.length>0?"?"+o.join("&"):"")}return t}function validate(t){var e=t||window.event;if("paste"===e.type)s=event.clipboardData.getData("text/plain");else{var s=e.keyCode||e.which;s=String.fromCharCode(s)}/[0-9]|\./.test(s)||(e.returnValue=!1,e.preventDefault&&e.preventDefault())}Vue.component("bind-login",{props:["show","type"],template:b2_global.bind_login,data:()=>({locked:!1,count:60,SMSLocked:!1,data:{img_code:"",token:"",username:"",password:"",confirmPassword:"",code:""},eye:!1,success:""}),computed:{userData(){return this.$store.state.userData}},methods:{close(){this.$emit("close")},showCheck(){return!("text"===this.type||"luo"===this.type||!this.data.username||!this.show)},sendCode(){recaptcha.show=!0,recaptcha.type="bind",this.close()},sendSMS(){1!=this.SMSLocked&&(this.SMSLocked=!0,this.$http.post(b2_rest_url+"sendCode",Qs.stringify(this.data)).then((t=>{t.data.token&&(this.countdown(),this.data.smsToken=t.data.token),this.SMSLocked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.SMSLocked=!1})))},countdown(){this.count<=1?this.count=60:(this.count--,setTimeout((()=>{this.countdown()}),1e3))},setToken(t){this.data.img_code=t.value,this.data.token=t.token,this.sendSMS()},submit(){this.locked||(this.locked=!0,this.$http.post(b2_rest_url+"bindUserLogin",Qs.stringify(this.data)).then((t=>{this.success=t.data,this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1})))}}});var b2bindLogin=new Vue({el:"#binding-login",data:{show:!1,type:!1},methods:{close(){this.show=!this.show},imgCodeAc(t){this.$refs.bindBox.setToken(t)}},watch:{type(t){t&&(this.show=!0)}}}),b2CreditTop=new Vue({el:".credit-top",data:{settings:[],data:""},mounted(){this.$refs.creditTop&&(this.settings=JSON.parse(this.$refs.creditTop.getAttribute("data-settings")),this.getList())},methods:{getList(){this.$http.post(b2_rest_url+"getGoldTop",Qs.stringify(this.settings)).then((t=>{this.data=t.data,this.$nextTick((()=>{this.$refs.creditTopGujia.style.display="none"}))}))}}});function grin(t,e){if(document.selection)e.focus(),sel=document.selection.createRange(),sel.text=t,e.focus();else if(e.selectionStart||"0"==e.selectionStart){var s=e.selectionStart,i=e.selectionEnd,o=s;e.value=e.value.substring(0,s)+t+e.value.substring(i,e.value.length),o+=t.length,e.focus(),e.selectionStart=o,e.selectionEnd=o}else e.value+=t,e.focus()}var b2HotCircle=new Vue({el:".b2-widget-hot-circle",data:{data:"",count:6,type:"hot",paged:{hot:1,join:1,create:1},locked:!1},mounted(){this.$refs.hotCircle&&(this.count=this.$refs.hotCircle.getAttribute("data-count"),this.getCirclesList("hot"))},methods:{go(t){window.location.href=t},getCirclesList(t){if(!b2token&&"hot"!==t)return login.show=!0,void(login.type=1);if(!0===this.locked)return;this.locked=!0;let e={count:this.count,type:t,paged:this.paged[t]};this.$refs.gujia.style.display="block",this.data="",this.$http.post(b2_rest_url+"getCirclesList",Qs.stringify(e)).then((e=>{this.data=e.data,this.$nextTick((()=>{this.$refs.gujia.style.display="none"})),this.type=t,this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}}});window.scrollTo||(window.scrollTo=function(t,e){window.pageXOffset=t,window.pageYOffset=e}),window.scrollBy||(window.scrollBy=function(t,e){window.pageXOffset+=t,window.pageYOffset+=e}),document.body.scrollTo||(Element.prototype.scrollTo=function(t,e){this.scrollLeft=t,this.scrollTop=e}),document.body.scrollBy||(Element.prototype.scrollBy=function(t,e){this.scrollLeft+=t,this.scrollTop+=e});var payReturn=new Vue({el:"#pay-return",data:{login:!1},mounted(){b2token&&(this.login=!0)}});const searchBox=document.querySelectorAll(".search-module");if(searchBox)for(let t=0;t<searchBox.length;t++){let e=searchBox[t].getAttribute("data-i");new Vue({el:"#search-module-"+e,data:{link:b2_global.home_url,keyword:"",category:b2_global.js_text.global.all,show:!1},mounted(){document.onclick=()=>{this.show=!1}},methods:{picked(t,e,s){this.link=s,this.category=e,this.show=!1},pickedKey(t){}}})}var b2recommendedCircle=new Vue({el:".b2-widget-recommended-circle",data:{data:"",current:0},mounted(){this.$refs.recommendedGujia&&this.getCircles()},methods:{create(){b2token?window.open(b2_global.home_url+"/create-circle","_blank"):(login.show=!0,login.loginType=1)},getCircles(){let t=JSON.parse(this.$refs.recommendedGujia.getAttribute("data-ids"));if(0==t.length)return;let e={ids:t};this.$http.post(b2_rest_url+"getCircleDataByCircleIds",Qs.stringify(e)).then((t=>{this.data=t.data,this.$nextTick((()=>{this.$refs.recommendedGujia.style.display="none","undefined"!=typeof b2CirclePostBox&&(this.current=parseInt(b2CirclePostBox.$refs.textareaTopic.getAttribute("data-circle")))}))}))},go(t,e){if("undefined"!=typeof b2CirclePostBox){t.stopPropagation(),t.preventDefault();let s=this.data[e].id;return b2CirclePostBox.circle.picked=s,this.current=s,b2CircleList.pickedCircle("widget",s),b2CirclePostBox.getCurrentUserCircleData(),window.history.pushState(s,this.data[e].name,this.data[e].link),document.title=this.data[e].name+" "+b2_global.site_separator+" "+b2_global.site_name,b2AsideBar.goTop(),!1}}}});function b2getCookie(t){for(var e=t+"=",s=document.cookie.split(";"),i=0;i<s.length;i++){for(var o=s[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null}function b2setCookie(t,e){let s=b2_global.login_keep_days;var i="";if(s){var o=new Date;o.setTime(o.getTime()+24*s*60*60*1e3),i="; expires="+o.toUTCString()}document.cookie=t+"="+(e||"")+i+"; path=/"}function b2delCookie(t){document.cookie=t+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function b2tooltip(t){const e=document.querySelectorAll(t);if(e&&!(B2ClientWidth<768)){window.b2thistip=[];for(let t=0;t<e.length;t++)e[t].addEventListener("mouseover",(function(e){var s="<div class='b2tooltip' id='b2tooltip"+t+"'>"+this.getAttribute("data-title")+"</div>";document.body.insertAdjacentHTML("beforeend",s),window.b2thistip[t]=document.querySelector("#b2tooltip"+t),window.b2thistip[t].style.top=e.pageY+10+"px",window.b2thistip[t].style.left=e.pageX+15+"px",window.b2thistip[t].style.display="block"}),!1),e[t].addEventListener("mouseout",(function(e){void 0!==window.b2thistip[t]&&window.b2thistip[t].remove()})),e[t].addEventListener("mousemove",(function(e){window.b2thistip[t].style.top=e.pageY+10+"px",window.b2thistip[t].style.left=e.pageX+15+"px"}))}}function b2fingerprint(){var t=document.createElement("canvas"),e=t.getContext("2d"),s="i9asdm..$#po((^@KbXrww!~cz";e.textBaseline="top",e.font="16px 'Arial'",e.textBaseline="alphabetic",e.rotate(.05),e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(s,2,15),e.fillStyle="rgba(102, 200, 0, 0.7)",e.fillText(s,4,17),e.shadowBlur=10,e.shadowColor="blue",e.fillRect(-20,10,234,5);var o=t.toDataURL(),a=0;if(0!=o.length){for(i=0;i<o.length;i++)char=o.charCodeAt(i),a=(a<<5)-a+char,a&=a;return a}}b2tooltip(".b2tooltipbox");var b2stream=new Vue({el:"#b2-stream",data:{paged:1,pages:0,author:1,data:"",empty:!1,locked:!1},mounted(){this.$refs.b2stream&&(this.paged=this.$refs.b2stream.getAttribute("data-paged"),this.author=this.$refs.b2stream.getAttribute("data-author"),this.getList())},methods:{getList(){this.$http.post(b2_rest_url+"getStreamList","paged="+this.paged+"&author="+this.author).then((t=>{this.data=t.data,0==this.data.length&&(this.empty=!0),this.$refs.gujia.style.display="none",this.$nextTick((()=>{b2SidebarSticky()}))}))},vote(t,e,s){if(b2token){if(1==this.locked)return;this.locked=!0,this.$http.post(b2_rest_url+"postVote","type="+t+"&post_id="+e).then((t=>{this.$set(this.data[s].data.data,"up",parseInt(this.data[s].data.data.up)+parseInt(t.data.up)),this.$set(this.data[s].data.data,"down",parseInt(this.data[s].data.data.down)+parseInt(t.data.down)),t.data.up>0?this.$set(this.data[s].data.data,"up_isset",1):this.$set(this.data[s].data.data,"up_isset",0),t.data.down>0?this.$set(this.data[s].data.data,"down_isset",1):this.$set(this.data[s].data.data,"down_isset",0),this.locked=!1})).catch((t=>{Qmsg.warning(t.response.data.message,{html:!0}),this.locked=!1}))}else login.show=!0}}});function b2loadScript(t,e,s){var i=document.createElement("script");i.type="text/javascript",i.id=e,i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=null,s())}:i.onload=function(){s()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)}
//# sourceMappingURL=/sm/d9e0b73eb09c7c732b2d30ad610c02ff088b32a7eef82c6d2cc48a2c55b810e9.map
